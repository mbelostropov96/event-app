<?php

namespace Database\Seeders;

use App\Enums\EventType;
use App\Models\Event;
use Illuminate\Database\Seeder;
use Carbon\Carbon;

class EventSeeder extends Seeder
{
    private array $balakovo_locations = [
        'МАУК "Дворец культуры" (набережная Леонова, 1А)',
        'Городской центр искусств им. М.Э. Сиропова (ул. Коммунистическая, 124)',
        'Балаковский ТЮЗ им. Е.А. Лебедева (ул. Титова, 2А)',
        'Усадьба Паисия Мальцева (ул. Коммунистическая, 75)',
        'Городской парк культуры и отдыха (ул. Факел Социализма, 12А)',
        'Спортивный комплекс "Форум" (ул. Степная, 70)',
        'Стадион "Труд" (ул. Комарова, 1)',
        'Центр культуры, спорта и молодёжной политики (ул. Заречная, 22)',
        'Музей истории города Балаково (ул. Коммунистическая, 100)',
        'Балаковский драматический театр им. Е.А. Лебедева (ул. Титова, 2)',
        'Центральная библиотека (ул. 30 лет Победы, 37А)',
        'Дворец спорта (наб. Леонова, 20)',
    ];

    private array $cultural_events = [
        'Концерт симфонического оркестра' => 'Великолепный концерт классической музыки в исполнении симфонического оркестра',
        'Театральная постановка "Вишневый сад"' => 'Классическая пьеса А.П. Чехова в современной интерпретации',
        'Выставка "Художники Поволжья"' => 'Выставка работ современных художников Поволжского региона',
        'Вечер русского романса' => 'Концертная программа с исполнением классических русских романсов',
        'Фотовыставка "Балаково: история и современность"' => 'Уникальная экспозиция фотографий города разных лет',
        'Литературный вечер' => 'Встреча с современными поэтами и писателями Саратовской области',
        'Концерт народной музыки' => 'Выступление ансамбля народных инструментов',
        'Балет "Лебединое озеро"' => 'Гастроли театра классического балета',
    ];

    private array $sports_events = [
        'Турнир по волейболу' => 'Городской турнир по волейболу среди любительских команд',
        'Соревнования по плаванию' => 'Открытый чемпионат города по плаванию',
        'Футбольный матч' => 'Матч чемпионата области по футболу',
        'Баскетбольный турнир' => 'Межрегиональные соревнования по баскетболу',
        'Спортивная гимнастика' => 'Показательные выступления гимнастов',
        'Турнир по настольному теннису' => 'Городской турнир по настольному теннису',
    ];

    private array $educational_events = [
        'Лекция по истории края' => 'Увлекательная лекция об истории Саратовского Поволжья',
        'Мастер-класс по живописи' => 'Практическое занятие по технике масляной живописи',
        'Семинар по экологии' => 'Обсуждение экологических проблем региона и путей их решения',
        'Научно-популярная лекция' => 'Современные достижения науки простым языком',
        'Краеведческая конференция' => 'Конференция, посвященная истории Балаково',
    ];

    private array $entertainment_events = [
        'Стендап шоу' => 'Вечер юмора с участием известных комиков',
        'Квиз "Что? Где? Когда?"' => 'Интеллектуальная игра для всех желающих',
        'Караоке-вечер' => 'Развлекательная программа с живой музыкой',
        'Фестиваль еды' => 'Гастрономический праздник с участием лучших ресторанов города',
        'Детский праздник' => 'Развлекательная программа для детей с аниматорами',
        'Дискотека 90-х' => 'Танцевальный вечер с хитами 90-х годов',
        'Шоу иллюзионистов' => 'Магическое представление с участием профессиональных иллюзионистов',
    ];

    public function run(): void
    {
        $events = [];
        
        // Добавляем культурные события
        foreach ($this->cultural_events as $title => $description) {
            $events[] = $this->createEventData($title, $description, EventType::CULTURAL);
        }

        // Добавляем спортивные события
        foreach ($this->sports_events as $title => $description) {
            $events[] = $this->createEventData($title, $description, EventType::SPORTS);
        }

        // Добавляем образовательные события
        foreach ($this->educational_events as $title => $description) {
            $events[] = $this->createEventData($title, $description, EventType::EDUCATIONAL);
        }

        // Добавляем развлекательные события
        foreach ($this->entertainment_events as $title => $description) {
            $events[] = $this->createEventData($title, $description, EventType::ENTERTAINMENT);
        }

        // Создаем события в базе данных
        foreach ($events as $event) {
            Event::create($event);
        }
    }

    private function createEventData(string $title, string $description, EventType $type): array
    {
        // Генерируем случайную дату в промежутке от завтра до 3 месяцев вперед
        $startDate = Carbon::now()->addDays(rand(1, 90));
        
        // Генерируем случайное время (с 10:00 до 20:00)
        $hour = rand(10, 19);
        $minute = rand(0, 1) * 30; // Либо 0, либо 30 минут
        $startTime = sprintf('%02d:%02d', $hour, $minute);

        // Генерируем случайную стоимость (от 100 до 3000 рублей, кратно 100)
        $price = rand(1, 30) * 100;

        return [
            'title' => $title,
            'description' => $description,
            'location' => $this->balakovo_locations[array_rand($this->balakovo_locations)],
            'start_date' => $startDate,
            'start_time' => $startTime,
            'price' => $price,
            'type' => $type,
        ];
    }
}
